@using ColmanWebProject.Models;
@using System.Globalization;

@model IEnumerable<Category>

@{
    TextInfo textInfo = new CultureInfo("en-US", false).TextInfo;
    Dictionary<String, List<String>> NavbarOptions = new Dictionary<String, List<String>>();

    @foreach (var item in Model)
    {
        if (!NavbarOptions.ContainsKey(item.Type))
        {
            NavbarOptions.Add(item.Type, new List<string>());

        }
        NavbarOptions[item.Type].Add(item.SubType);
    }
}

<nav class="navbar navbar-expand-md navbar-light bg-light main-menu" style="box-shadow:none">
    <div class="container">

        <button type="button" id="sidebarCollapse" class="btn btn-link d-block d-md-none">
            <i class="bx bx-menu icon-single"></i>
        </button>

        <a class="navbar-brand" href="#">
            <h4 class="font-weight-bold">Colman</h4>
        </a>

        <ul class="navbar-nav ml-auto d-block d-md-none">
            <li class="nav-item">
                <a class="btn btn-link" href="#"><i class="bx bxs-heart icon-single"></i> <span class="badge badge-danger">3</span></a>
            </li>
            <li class="nav-item">
                <a class="btn btn-link" href="/Carts"><i class="bx bxs-cart icon-single"></i> <span class="badge badge-danger">2</span></a>
            </li>
        </ul>

        <div class="collapse navbar-collapse">
            <form id="searchForm" class="form-inline my-2 my-lg-0 mx-auto">
                <input name="queryTitle" id="searchValue" class="form-control" type="search" placeholder="Search for products..." aria-label="Search">
                <button class="btn btn-success my-2 my-sm-0" type="submit"><i class="bx bx-search"></i></button>
            </form>

            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="btn btn-link" href="/WishLists"><i class="bx bxs-heart icon-single"></i> <span class="badge badge-danger">3</span></a>
                </li>
                <li class="nav-item">
                    <a class="btn btn-link" href="/Carts"><i class="bx bxs-cart icon-single"></i> <span class="badge badge-danger">2</span></a>
                </li>
            </ul>
        </div>

    </div>
</nav>

<nav class="navbar navbar-expand-md navbar-light bg-light sub-menu">
    <div class="container">
        <div class="collapse navbar-collapse" id="navbar">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                </li>

                @foreach (KeyValuePair<string, List<string>> navbarOption in NavbarOptions)
                {
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            @navbarOption.Key
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            @foreach (var subNavbarOption in navbarOption.Value)
                            {
                                <a asp-controller="Products" asp-action="Index" asp-route-Catagory="@navbarOption.Key" asp-route-SubCatagory="@subNavbarOption" class="dropdown-item">@subNavbarOption</a>
                            }
                        </div>
                    </li>
                }
                @if (Context.User != null && Context.User.Claims != null && Context.User.Claims.Count() > 0 && Context.User.IsInRole("Admin"))
                {
                    <li class="nav-item dropdown nav-item-manager">
                        <a class="nav-link dropdown-toggle nav-item-manager" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Manager
                        </a>
                        <div class="dropdown-menu nav-item-manager" aria-labelledby="navbarDropdown">
                            <a asp-controller="Categories" asp-action="Index" class="dropdown-item nav-item-manager">Manage Categories</a>
                            <a asp-controller="Customers" asp-action="Index" class="dropdown-item nav-item-manager">Manage Customers</a>
                            <a asp-controller="Products" asp-action="ManageProducts" class="dropdown-item nav-item-manager">Manage Products</a>
                            <a asp-controller="Stores" asp-action="Index" class="dropdown-item nav-item-manager">Manage Stores</a>
                        </div>
                    </li>

                }
             </ul>
        </div>
    </div>
</nav>

<div class="search-bar d-block d-md-none">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <form class="form-inline mb-3 mx-auto">
                    <input class="form-control" type="search" placeholder="Search for products..." aria-label="Search">
                    <button class="btn btn-success" type="submit"><i class="bx bx-search"></i></button>
                </form>
            </div>
        </div>
    </div>
</div>

<nav id="sidebar">
    <div class="sidebar-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-10 pl-0">
                    <a class="btn btn-primary" href="#"><i class="bx bxs-user-circle mr-1"></i> Log In</a>
                </div>

                <div class="col-2 text-left">
                    <button type="button" id="sidebarCollapseX" class="btn btn-link">
                        <i class="bx bx-x icon-single"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <ul class="list-unstyled components links">
        <li class="active">
            <a href="#"><i class="bx bx-home mr-3"></i>Home</a>
        </li>

        @foreach (KeyValuePair<string, List<string>> navbarOption in NavbarOptions)
        {
            <li>
                <a href="#@textInfo.ToLower(navbarOption.Key)Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                    @navbarOption.Key
                </a>
                <ul class="collapse list-unstyled" id="@textInfo.ToLower(navbarOption.Key)Submenu">
                    @foreach (var subNavbarOption in navbarOption.Value)
                    {
                        <a asp-controller="Products" asp-action="Index" asp-route-Catagory="@navbarOption.Key" asp-route-SubCatagory="@subNavbarOption">@subNavbarOption</a>
                    }
                </ul>
            </li>
        }

        @if (Context.User != null && Context.User.Claims != null && Context.User.Claims.Count() > 0 && Context.User.IsInRole("Admin"))
        {

            <li>
                <a href="#ManagerSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle nav-item-manager">
                    Manager
                </a>
                <ul class="collapse list-unstyled nav-item-manager" id="ManagerSubmenu">
                    <a asp-controller="Categories" asp-action="Index" class="dropdown-item nav-item-manager">Manage Categories</a>
                    <a asp-controller="Customers" asp-action="Index" class="dropdown-item nav-item-manager">Manage Customers</a>
                    <a asp-controller="Products" asp-action="ManageProducts" class="dropdown-item nav-item-manager">Manage Products</a>
                    <a asp-controller="Stores" asp-action="Index" class="dropdown-item nav-item-manager">Manage Stores</a>
                </ul>
            </li>
        }
    </ul>

    <ul class="social-icons">
        <li><a href="#" target="_blank"><i class="bx bxl-facebook-square"></i></a></li>
        <li><a href="#" target="_blank"><i class="bx bxl-twitter"></i></a></li>
        <li><a href="#" target="_blank"><i class="bx bxl-linkedin"></i></a></li>
        <li><a href="#" target="_blank"><i class="bx bxl-instagram"></i></a></li>
    </ul>

</nav>

